---
title: 'Exploratory analysis: associations'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, warning = F, message = F)
```

```{r}
rm(list=ls())
suppressPackageStartupMessages(library(bigrquery))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(ggplot2))
setwd("~/Documents/Github_mining/src/R/exploratory_analysis")
source("project_info.R")
source("languages.R")
source("quality.R")
```
# Bug fix commits


```{r}
### Filter for projects with a lot of commits
commits_filtered <- filter(repo_level_data, num_commits > 100)
```

### Relationship with number of test cases

```{r echo = T}
summary(lm(num_bug_fix_commits ~ num_test_cases + num_commits, data = repo_level_data))
summary(lm(num_bug_fix_commits ~ num_test_cases + num_commits, data = commits_filtered))
```

### Relationship with language

```{r echo = T}
lm_bug_fix_lang <- function(lang) {
  summary(lm(num_bug_fix_commits ~ get(lang, envir = as.environment(repo_level_data)) + num_commits + num_test_cases,
             data = repo_level_data))$coefficients[2,]
}
lang_coef_bug_fix <- t(sapply(top_languages, lm_bug_fix_lang))
ord <- order(lang_coef_bug_fix[,4])
lang_coef_bug_fix[ord,]
```

### Relationship with number of languages

```{r echo = T}
summary(lm(num_bug_fix_commits ~ num_languages + num_commits, data = repo_level_data))
summary(lm(num_bug_fix_commits ~ num_languages + num_commits, data = commits_filtered))
```

# Number of test cases

### Relationship with language

```{r echo = T}
lm_test_case_lang <- function(lang) {
  summary(lm(total_lines_test_cases ~ 
               get(lang, envir = as.environment(repo_level_data)) + lines_of_code, 
             data = repo_level_data))$coefficients[2,]
}
lang_coef_test_cases <- t(sapply(top_languages, lm_test_case_lang))
ord <- order(lang_coef_test_cases[,4])
lang_coef_test_cases[ord,]
```





